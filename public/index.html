<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Swamp Study ‚Äì Login</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 420px; margin: 60px auto; }
    h1 { text-align: center; margin-bottom: 10px; }
    .tabs { display: flex; gap: 8px; justify-content: center; margin-bottom: 16px; }
    .tabs button { padding: 8px 12px; border: 1px solid #ccc; background: #f5f5f5; cursor: pointer; border-radius: 8px; }
    .tabs button.active { background: #2c7be5; color: white; border-color: #2c7be5; }
    form { display: grid; gap: 10px; background: #fafafa; padding: 16px; border: 1px solid #eee; border-radius: 12px; }
    input { padding: 10px; border: 1px solid #ccc; border-radius: 8px; }
    .btn { padding: 10px; border: none; border-radius: 8px; background: #2c7be5; color: white; cursor: pointer; }
    .error { color: #c00; height: 18px; font-size: 13px; }
  </style>
</head>
<body>
  <img src="gatorwelcome.png" alt="Swamp Study Logo" width="200" style="display:block;margin:0 auto 10px;">
  <h1>üêä Swamp Study</h1>
  <div class="tabs">
    <button id="tab-login" class="active">Log In</button>
    <button id="tab-signup">Sign Up</button>
  </div>

  <form id="form">
    <input id="username" placeholder="Username" required />
    <input id="password" type="password" placeholder="Password" required />
    <div class="error" id="error"></div>
    <button class="btn" id="submit">Log In</button>
  </form>

  <script>
    const form = document.getElementById("form");
    const username = document.getElementById("username");
    const password = document.getElementById("password");
    const errorBox = document.getElementById("error");
    const tabLogin = document.getElementById("tab-login");
    const tabSignup = document.getElementById("tab-signup");
    const submitBtn = document.getElementById("submit");

    let mode = "login"; // or "signup"

    tabLogin.onclick = () => {
      mode = "login";
      tabLogin.classList.add("active");
      tabSignup.classList.remove("active");
      submitBtn.textContent = "Log In";
      errorBox.textContent = "";
    };

    tabSignup.onclick = () => {
      mode = "signup";
      tabSignup.classList.add("active");
      tabLogin.classList.remove("active");
      submitBtn.textContent = "Sign Up";
      errorBox.textContent = "";
    };

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      errorBox.textContent = "";
      const body = { username: username.value.trim(), password: password.value.trim() };
      if (!body.username || !body.password) return;

      try {
        const res = await fetch(`/api/${mode}`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(body)
        });
        const data = await res.json();
        if (!res.ok) {
          errorBox.textContent = data.error || "Something went wrong";
          return;
        }
        // Save who logged in (demo only)
        localStorage.setItem("swamp_user", data.username);
        // Go to the "protected" page
        location.href = "/home.html";
      } catch (err) {
        errorBox.textContent = "Network error";
      }
    });
  </script>
</body>
</html>
